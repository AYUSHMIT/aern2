<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
    Module      :  AERN2.Sequence.Branching
    Description :  branching operations for sequences
    Copyright   :  (c) Michal Konecny, Eike Neumann
    License     :  BSD3

    Maintainer  :  mikkonecny@gmail.com
    Stability   :  experimental
    Portability :  portable

    Branching operations for sequences
-}</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span class="hs-operator">.</span><span class="hs-identifier">Branching</span><span>
</span><a name="line-14"></a><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>  </span><a href="AERN2.Sequence.Comparison.html#SeqBoolP"><span class="hs-identifier hs-type">SeqBoolP</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Comparison.html#SeqBoolA"><span class="hs-identifier hs-type">SeqBoolA</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Comparison.html#SeqBool"><span class="hs-identifier hs-type">SeqBool</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Comparison.html#pBool"><span class="hs-identifier hs-var">pBool</span></a><span>
</span><a name="line-16"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Comparison.html#SequenceAtAccuracy"><span class="hs-identifier hs-type">SequenceAtAccuracy</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Branching.html#pickNonZeroSeqA"><span class="hs-identifier hs-var">pickNonZeroSeqA</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Branching.html#pick"><span class="hs-identifier hs-var">pick</span></a><span>
</span><a name="line-18"></a><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">where</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MixedTypesNumPrelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- import qualified Prelude as P</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">catMaybes</span><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">MP</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span class="hs-keyword">import</span><span> </span><a href="AERN2.QA.Protocol.html"><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">QA</span><span class="hs-operator">.</span><span class="hs-identifier">Protocol</span></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><a href="AERN2.AccuracySG.html"><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">AccuracySG</span></a><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="AERN2.Sequence.Type.html"><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- import AERN2.Sequence.Helpers (ensureAccuracyA)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="AERN2.Sequence.Comparison.html"><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span class="hs-operator">.</span><span class="hs-identifier">Comparison</span></a><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span class="hs-comment">{- non-zero picking -}</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">{-|
  Given a list @[(a1,b1),(a2,b2),...]@ and assuming that
  at least one of @a1,a2,...@ is non-zero, pick one of them
  and return the corresponding pair @(ai,bi)@.

  If none of @a1,a2,...@ is zero, either throw an exception
  or loop forever.
 -}</span><span>
</span><a name="line-46"></a><span class="hs-identifier">pickNonZeroSeqA</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAArrow"><span class="hs-identifier hs-type">QAArrow</span></a><span> </span><a href="#local-6989586621679785633"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">CanPickNonZero</span><span> </span><a href="#local-6989586621679785634"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785633"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785633"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785634"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785635"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">to</span><span class="hs-special">`</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785633"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785634"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785635"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><a name="pickNonZeroSeqA"><a href="AERN2.Sequence.Branching.html#pickNonZeroSeqA"><span class="hs-identifier">pickNonZeroSeqA</span></a></a><span> </span><a name="local-6989586621679785636"><a href="#local-6989586621679785636"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-52"></a><span>  </span><a href="#local-6989586621679785637"><span class="hs-identifier hs-var">startFromAccuracy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bits</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-54"></a><span>  </span><a name="local-6989586621679785637"><a href="#local-6989586621679785637"><span class="hs-identifier">startFromAccuracy</span></a></a><span> </span><a name="local-6989586621679785638"><a href="#local-6989586621679785638"><span class="hs-identifier">ac</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-identifier">proc</span><span> </span><a name="local-6989586621679785639"><a href="#local-6989586621679785639"><span class="hs-identifier">seqsAndS</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-56"></a><span>      </span><a name="local-6989586621679785640"><a href="#local-6989586621679785640"><span class="hs-identifier">balls</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="AERN2.Sequence.Type.html#seqsWithAccuracyA"><span class="hs-identifier hs-var">seqsWithAccuracyA</span></a><span> </span><a href="#local-6989586621679785636"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679785639"><span class="hs-identifier hs-var">seqsAndS</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.AccuracySG.html#accuracySG"><span class="hs-identifier hs-var">accuracySG</span></a><span> </span><a href="#local-6989586621679785638"><span class="hs-identifier hs-var">ac</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>      </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679785641"><a href="#local-6989586621679785641"><span class="hs-identifier">maybeNonZero</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pickNonZero</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679785640"><span class="hs-identifier hs-var">balls</span></a><span> </span><a href="#local-6989586621679785639"><span class="hs-identifier hs-var">seqsAndS</span></a><span>
</span><a name="line-58"></a><span>      </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679785641"><span class="hs-identifier hs-var">maybeNonZero</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679785642"><a href="#local-6989586621679785642"><span class="hs-identifier">result</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">returnA</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679785642"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-60"></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679785637"><span class="hs-identifier hs-var">startFromAccuracy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785638"><span class="hs-identifier hs-var">ac</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><a href="#local-6989586621679785639"><span class="hs-identifier hs-var">seqsAndS</span></a><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CanPickNonZero</span><span> </span><a href="#local-6989586621679785683"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">CanPickNonZero</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#Sequence"><span class="hs-identifier hs-type">Sequence</span></a><span> </span><a href="#local-6989586621679785683"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-63"></a><span>  </span><a name="local-8214565720323804468"><span class="hs-identifier">pickNonZero</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="AERN2.Sequence.Branching.html#pickNonZeroSeqA"><span class="hs-identifier hs-var">pickNonZeroSeqA</span></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-comment">{-| &quot;parallel if&quot; -}</span><span>
</span><a name="line-66"></a><span class="hs-keyword">instance</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAArrow"><span class="hs-identifier hs-type">QAArrow</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">ArrowApply</span><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span>
</span><a name="line-68"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HasIfThenElse</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-69"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">HasIfThenElse</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="AERN2.AccuracySG.html#AccuracySG"><span class="hs-identifier hs-type">AccuracySG</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">IfThenElseType</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="AERN2.AccuracySG.html#AccuracySG"><span class="hs-identifier hs-type">AccuracySG</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="AERN2.AccuracySG.html#AccuracySG"><span class="hs-identifier hs-type">AccuracySG</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IfThenElseType</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Type.html#SuitableForSeq"><span class="hs-identifier hs-type">SuitableForSeq</span></a><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Type.html#SuitableForSeq"><span class="hs-identifier hs-type">SuitableForSeq</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Type.html#SuitableForSeq"><span class="hs-identifier hs-type">SuitableForSeq</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IfThenElseType</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-identifier hs-type">HasIfThenElse</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">IfThenElseType</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IfThenElseType</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>  </span><a name="local-8214565720323804607"><span class="hs-identifier">ifThenElse</span></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785674"><a href="#local-6989586621679785674"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">::</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679785675"><a href="#local-6989586621679785675"><span class="hs-identifier">e1</span></a></a><span class="hs-glyph">::</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785671"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679785676"><a href="#local-6989586621679785676"><span class="hs-identifier">e2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-77"></a><span>    </span><a href="AERN2.Sequence.Type.html#newSeq"><span class="hs-identifier hs-var">newSeq</span></a><span> </span><a href="#local-6989586621679785677"><span class="hs-identifier hs-var">sampleT</span></a><span> </span><span class="hs-string">&quot;pif&quot;</span><span> </span><span class="hs-special">[</span><a href="AERN2.QA.Protocol.html#AnyProtocolQA"><span class="hs-identifier hs-var">AnyProtocolQA</span></a><span> </span><a href="#local-6989586621679785674"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.QA.Protocol.html#AnyProtocolQA"><span class="hs-identifier hs-var">AnyProtocolQA</span></a><span> </span><a href="#local-6989586621679785675"><span class="hs-identifier hs-var">e1</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.QA.Protocol.html#AnyProtocolQA"><span class="hs-identifier hs-var">AnyProtocolQA</span></a><span> </span><a href="#local-6989586621679785676"><span class="hs-identifier hs-var">e2</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679785678"><span class="hs-identifier hs-var">makeQ</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-79"></a><span>    </span><a name="local-6989586621679785677"><a href="#local-6989586621679785677"><span class="hs-identifier">sampleT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IfThenElseType</span><span> </span><a href="#local-6989586621679785672"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679785673"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>    </span><a name="local-6989586621679785678"><a href="#local-6989586621679785678"><span class="hs-identifier">makeQ</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785679"><a href="#local-6989586621679785679"><span class="hs-identifier">me</span></a></a><span class="hs-special">,</span><a name="local-6989586621679785680"><a href="#local-6989586621679785680"><span class="hs-identifier">_src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-81"></a><span>      </span><span class="hs-identifier">proc</span><span> </span><a name="local-6989586621679785681"><a href="#local-6989586621679785681"><span class="hs-identifier">ac</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-82"></a><span>        </span><span class="hs-keyword">do</span><span>
</span><a name="line-83"></a><span>        </span><a name="local-6989586621679785682"><a href="#local-6989586621679785682"><span class="hs-identifier">bAC</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#-%3F%3C-"><span class="hs-operator hs-var">-?&lt;-</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679785679"><span class="hs-identifier hs-var">me</span></a><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785674"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785681"><span class="hs-identifier hs-var">ac</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>        </span><span class="hs-identifier hs-var">app</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679785682"><span class="hs-identifier hs-var">bAC</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785675"><span class="hs-identifier hs-var">e1</span></a><span> </span><a href="AERN2.QA.Protocol.html#%3F%3C-"><span class="hs-operator hs-var">?&lt;-</span></a><span> </span><a href="#local-6989586621679785679"><span class="hs-identifier hs-var">me</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785676"><span class="hs-identifier hs-var">e2</span></a><span> </span><a href="AERN2.QA.Protocol.html#%3F%3C-"><span class="hs-operator hs-var">?&lt;-</span></a><span> </span><a href="#local-6989586621679785679"><span class="hs-identifier hs-var">me</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785681"><span class="hs-identifier hs-var">ac</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- instance</span><span>
</span><a name="line-87"></a><span class="hs-comment">--   (QAArrow to, ArrowApply to</span><span>
</span><a name="line-88"></a><span class="hs-comment">--   , HasIfThenElse b t</span><span>
</span><a name="line-89"></a><span class="hs-comment">--   , HasIfThenElse b (to AccuracySG t)</span><span>
</span><a name="line-90"></a><span class="hs-comment">--   -- , IfThenElseType b (to AccuracySG t) ~ to AccuracySG (IfThenElseType b t)</span><span>
</span><a name="line-91"></a><span class="hs-comment">--   , IfThenElseType b (([Maybe (QAId to)], [t])) ~ (([Maybe (QAId to)], [IfThenElseType b t]))</span><span>
</span><a name="line-92"></a><span class="hs-comment">--   , IfThenElseType b (to AccuracySG ([Maybe (QAId to)], [t])) ~ to AccuracySG (IfThenElseType b ([Maybe (QAId to)], [t]))</span><span>
</span><a name="line-93"></a><span class="hs-comment">--   , SuitableForSeq b, SuitableForSeq t, SuitableForSeq (IfThenElseType b t))</span><span>
</span><a name="line-94"></a><span class="hs-comment">--   =&gt;</span><span>
</span><a name="line-95"></a><span class="hs-comment">--   HasIfThenElse (SequenceA to b) [(SequenceA to t)]</span><span>
</span><a name="line-96"></a><span class="hs-comment">--   where</span><span>
</span><a name="line-97"></a><span class="hs-comment">--   type IfThenElseType (SequenceA to b) [(SequenceA to t)] = () `to` [(SequenceA to (IfThenElseType b t))]</span><span>
</span><a name="line-98"></a><span class="hs-comment">--   ifThenElse (b::SequenceA to b) (e1::[SequenceA to t]) e2 =</span><span>
</span><a name="line-99"></a><span class="hs-comment">--     sequence2list $</span><span>
</span><a name="line-100"></a><span class="hs-comment">--       newSeq sampleT &quot;pifList&quot; [AnyProtocolQA b] makeQ</span><span>
</span><a name="line-101"></a><span class="hs-comment">--       where</span><span>
</span><a name="line-102"></a><span class="hs-comment">--       sampleT = undefined :: ([Maybe (QAId to)], [IfThenElseType b t])</span><span>
</span><a name="line-103"></a><span class="hs-comment">--       makeQ (me,_src) =</span><span>
</span><a name="line-104"></a><span class="hs-comment">--         proc ac -&gt;</span><span>
</span><a name="line-105"></a><span class="hs-comment">--           do</span><span>
</span><a name="line-106"></a><span class="hs-comment">--           bAC &lt;- (-?-) -&lt; (b, ac)</span><span>
</span><a name="line-107"></a><span class="hs-comment">--           let eS = if bAC</span><span>
</span><a name="line-108"></a><span class="hs-comment">--                       then (list2sequence e1 ?&lt;- me)</span><span>
</span><a name="line-109"></a><span class="hs-comment">--                       else (list2sequence e2 ?&lt;- me)</span><span>
</span><a name="line-110"></a><span class="hs-comment">--           app -&lt; (eS, (ac+1))</span><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-identifier">list2sequence</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAArrow"><span class="hs-identifier hs-type">QAArrow</span></a><span> </span><a href="#local-6989586621679785631"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Type.html#SuitableForSeq"><span class="hs-identifier hs-type">SuitableForSeq</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785631"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679785632"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">[</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785631"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785632"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785631"><span class="hs-identifier hs-type">to</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785631"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679785632"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><a name="list2sequence"><a href="AERN2.Sequence.Branching.html#list2sequence"><span class="hs-identifier">list2sequence</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785645"><a href="#local-6989586621679785645"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785643"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785644"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-117"></a><span>  </span><a href="AERN2.Sequence.Type.html#newSeq"><span class="hs-identifier hs-var">newSeq</span></a><span> </span><a href="#local-6989586621679785646"><span class="hs-identifier hs-var">sampleT</span></a><span> </span><span class="hs-string">&quot;list&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679785647"><span class="hs-identifier hs-var">makeQ</span></a><span>
</span><a name="line-118"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-6989586621679785646"><a href="#local-6989586621679785646"><span class="hs-identifier">sampleT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785643"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679785644"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>  </span><a name="local-6989586621679785647"><a href="#local-6989586621679785647"><span class="hs-identifier">makeQ</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785648"><a href="#local-6989586621679785648"><span class="hs-identifier">me</span></a></a><span class="hs-special">,</span><a name="local-6989586621679785649"><a href="#local-6989586621679785649"><span class="hs-identifier">_src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-identifier">proc</span><span> </span><a name="local-6989586621679785650"><a href="#local-6989586621679785650"><span class="hs-identifier">ac</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-122"></a><span>      </span><span class="hs-keyword">do</span><span>
</span><a name="line-123"></a><span>      </span><a name="local-6989586621679785651"><a href="#local-6989586621679785651"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="AERN2.QA.Protocol.html#qaMakeQueryOnManyA"><span class="hs-identifier hs-var">qaMakeQueryOnManyA</span></a><span> </span><a href="#local-6989586621679785648"><span class="hs-identifier hs-var">me</span></a><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785645"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">,</span><a href="#local-6989586621679785650"><span class="hs-identifier hs-var">ac</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>      </span><span class="hs-identifier hs-var">returnA</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="AERN2.Sequence.Type.html#seqId"><span class="hs-identifier hs-var">seqId</span></a><span> </span><a href="#local-6989586621679785645"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785651"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-identifier">sequence2list</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-127"></a><span>  </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAArrow"><span class="hs-identifier hs-type">QAArrow</span></a><span> </span><a href="#local-6989586621679785629"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.Sequence.Type.html#SuitableForSeq"><span class="hs-identifier hs-type">SuitableForSeq</span></a><span> </span><a href="#local-6989586621679785630"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-129"></a><span>  </span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785629"><span class="hs-identifier hs-type">to</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785629"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679785630"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">to</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785629"><span class="hs-identifier hs-type">to</span></a><span> </span><a href="#local-6989586621679785630"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span>
</span><a name="line-130"></a><a name="sequence2list"><a href="AERN2.Sequence.Branching.html#sequence2list"><span class="hs-identifier">sequence2list</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785654"><a href="#local-6989586621679785654"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785652"><span class="hs-identifier hs-type">to</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785652"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679785653"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-131"></a><span>  </span><span class="hs-identifier">proc</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-keyword">do</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">(</span><a name="local-6989586621679785664"><a href="#local-6989586621679785664"><span class="hs-identifier">sources</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#-%3F-"><span class="hs-operator hs-var">-?-</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785654"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="AERN2.AccuracySG.html#acSG0"><span class="hs-identifier hs-var">acSG0</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>    </span><span class="hs-identifier hs-var">returnA</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679785655"><span class="hs-identifier hs-var">forSource</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679785664"><span class="hs-identifier hs-var">sources</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>  </span><a name="local-6989586621679785655"><a href="#local-6989586621679785655"><span class="hs-identifier">forSource</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785656"><a href="#local-6989586621679785656"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679785657"><a href="#local-6989586621679785657"><span class="hs-identifier">src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-comment">-- newSeq sampleT &quot;list&quot; [AnyProtocolQA src] makeQ</span><span>
</span><a name="line-138"></a><span>    </span><a href="AERN2.Sequence.Type.html#newSeq"><span class="hs-identifier hs-var">newSeq</span></a><span> </span><a href="#local-6989586621679785658"><span class="hs-identifier hs-var">sampleT</span></a><span> </span><span class="hs-string">&quot;list&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679785659"><span class="hs-identifier hs-var">makeQ</span></a><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>    </span><a name="local-6989586621679785658"><a href="#local-6989586621679785658"><span class="hs-identifier">sampleT</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679785653"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-141"></a><span>    </span><a name="local-6989586621679785659"><a href="#local-6989586621679785659"><span class="hs-identifier">makeQ</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679785660"><a href="#local-6989586621679785660"><span class="hs-identifier">me</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679785661"><a href="#local-6989586621679785661"><span class="hs-identifier">_src</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-142"></a><span>      </span><span class="hs-identifier">proc</span><span> </span><a name="local-6989586621679785662"><a href="#local-6989586621679785662"><span class="hs-identifier">ac</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-143"></a><span>        </span><span class="hs-keyword">do</span><span>
</span><a name="line-144"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679785663"><a href="#local-6989586621679785663"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#-%3F%3C-"><span class="hs-operator hs-var">-?&lt;-</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679785660"><span class="hs-identifier hs-var">me</span></a><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785654"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785662"><span class="hs-identifier hs-var">ac</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>        </span><span class="hs-identifier hs-var">returnA</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><a href="#local-6989586621679785663"><span class="hs-identifier hs-var">ts</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><a href="#local-6989586621679785656"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-identifier">pick</span><span> </span><span class="hs-glyph">::</span><span>
</span><a name="line-148"></a><span>  </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAArrow"><span class="hs-identifier hs-type">QAArrow</span></a><span> </span><a href="#local-6989586621679785627"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="AERN2.QA.Protocol.html#QAId"><span class="hs-identifier hs-type">QAId</span></a><span> </span><a href="#local-6989586621679785627"><span class="hs-identifier hs-type">to</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-151"></a><span>  </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="AERN2.Sequence.Type.html#SequenceA"><span class="hs-identifier hs-type">SequenceA</span></a><span> </span><a href="#local-6989586621679785627"><span class="hs-identifier hs-type">to</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679785628"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">to</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679785628"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-152"></a><a name="pick"><a href="AERN2.Sequence.Branching.html#pick"><span class="hs-identifier">pick</span></a></a><span> </span><a name="local-6989586621679785665"><a href="#local-6989586621679785665"><span class="hs-identifier">src</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679785666"><span class="hs-identifier hs-var">aux</span></a><span> </span><span class="hs-special">(</span><a href="AERN2.AccuracySG.html#bitsS"><span class="hs-identifier hs-var">bitsS</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-154"></a><span>  </span><a name="local-6989586621679785666"><a href="#local-6989586621679785666"><span class="hs-identifier">aux</span></a></a><span> </span><a name="local-6989586621679785667"><a href="#local-6989586621679785667"><span class="hs-identifier">ac</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-identifier">proc</span><span> </span><a name="local-6989586621679785668"><a href="#local-6989586621679785668"><span class="hs-identifier">options</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-156"></a><span>      </span><span class="hs-keyword">do</span><span>
</span><a name="line-157"></a><span>      </span><a name="local-6989586621679785669"><a href="#local-6989586621679785669"><span class="hs-identifier">mas</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="AERN2.QA.Protocol.html#qaMakeQueryOnManyA"><span class="hs-identifier hs-var">qaMakeQueryOnManyA</span></a><span> </span><a href="#local-6989586621679785665"><span class="hs-identifier hs-var">src</span></a><span> </span><span class="hs-operator">-&lt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785668"><span class="hs-identifier hs-var">options</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679785667"><span class="hs-identifier hs-var">ac</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>      </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">catMaybes</span><span> </span><a href="#local-6989586621679785669"><span class="hs-identifier hs-var">mas</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-159"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679785666"><span class="hs-identifier hs-var">aux</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679785667"><span class="hs-identifier hs-var">ac</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><a href="#local-6989586621679785668"><span class="hs-identifier hs-var">options</span></a><span>
</span><a name="line-160"></a><span>        </span><span class="hs-special">(</span><a name="local-6989586621679785670"><a href="#local-6989586621679785670"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">returnA</span><span> </span><span class="hs-operator">-&lt;</span><span> </span><a href="#local-6989586621679785670"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">{- A very old idea, now superseded by pick:

{- tolerant comparisons -}

instance (CanNegSameType b, Arrow to) =&gt; CanNeg (() `to` b) where
  negate tob = arr negate &lt;&lt;&lt; tob

instance (QAArrow to) =&gt; HasTolerantEqAsymmetric (CauchyRealA to) (CauchyRealA to) where
  type TolerantEqCompareType (CauchyRealA to) (CauchyRealA to) = () `to` (Tolerant Bool)
  tolerantEqualTo a (e,b) =
    proc () -&gt;
      do
      aB &lt;- qaMakeQueryA -&lt; (a, ac)
      bB &lt;- qaMakeQueryA -&lt; (b, ac)
      returnA -&lt; tolerantEqualTo aB (e,bB)
    where
    ac =
      case getNormLog (dyadic e) of
        NormBits n -&gt; bits (max 0 (1 - n))
        NormZero -&gt; Exact
-}</span><span>
</span><a name="line-183"></a></pre></body></html>