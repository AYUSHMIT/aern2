<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Introduction</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">MixedTypesNumPrelude</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">Real</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">AERN2</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">-- import Debug.Trace</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- real numbers</span><span>
</span><a name="line-12"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-13"></a><span>
</span><a name="line-14"></a><span class="hs-comment">-- define a short name for the type of real numbers:</span><span>
</span><a name="line-15"></a><span class="hs-keyword">type</span><span> </span><a name="R"><a href="Introduction.html#R"><span class="hs-identifier">R</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CauchyReal</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- Real numbers are represented by fast converging sequences of dyadic intervals:</span><span>
</span><a name="line-17"></a><span class="hs-comment">--    CauchyReal = Sequence MPBall</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- A sequence is essentially a function from accuracy, ie number of bits:</span><span>
</span><a name="line-19"></a><span class="hs-comment">--    Sequence t = ... (AccuracySG -&gt; t)</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-comment">-- Start with a simple real number expression:</span><span>
</span><a name="line-22"></a><a name="sumSines1"><a href="Introduction.html#sumSines1"><span class="hs-identifier">sumSines1</span></a></a><span> </span><a name="local-6989586621679068390"><a href="#local-6989586621679068390"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-var">sin</span><span> </span><a href="#local-6989586621679069120"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679069120"><a href="#local-6989586621679069120"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">1</span><span class="hs-glyph">..</span><a href="#local-6989586621679068390"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">{-
  You can run many of the following yourself in ghci.
  If you installed AERN2 using the official instructions,
  you can start ghci using the following command in the base
  folder:

  stack repl aern2/aern2-demos/src/Introduction.hs
-}</span><span>
</span><a name="line-32"></a><span>
</span><a name="line-33"></a><span class="hs-comment">-- Request accuracy</span><span>
</span><a name="line-34"></a><span class="hs-comment">--    strict limit: 100 bits</span><span>
</span><a name="line-35"></a><span class="hs-comment">--    and guide: 120 bits</span><span>
</span><a name="line-36"></a><span class="hs-identifier">sumSines1_run1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MPBall</span><span>
</span><a name="line-37"></a><a name="sumSines1_run1"><a href="Introduction.html#sumSines1_run1"><span class="hs-identifier">sumSines1_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Introduction.html#sumSines1"><span class="hs-identifier hs-var">sumSines1</span></a><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsSG</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-number">120</span><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; sumSines1_run1
[-0.127171013660420115436752171427 &#177; &lt;2^(-112)]
(0.02 secs, 0 bytes)

Note that the result accuracy is somewhat below
the guide accuracy target of 120.  This is because the intermediate results are
computed with an accuracy that is not entirely sufficient for the target accuracy
of the final result.  When propagating requests to sub-expressions, we
avoid raising the accuracy requests unnecessarily so that in deeply nested
expressions the accuracy would not grow too fast. The price is that typically
we miss the accuracy target.
-}</span><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span class="hs-comment">-- Request 100 bits of the result of the above expression with n = 100:</span><span>
</span><a name="line-53"></a><a name="sumSines1_run2"><a href="Introduction.html#sumSines1_run2"><span class="hs-identifier">sumSines1_run2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Introduction.html#sumSines1"><span class="hs-identifier hs-var">sumSines1</span></a><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsSG</span><span> </span><span class="hs-number">100</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-comment">{- ghci log:
  *Introduction&gt; sumSines1_run2
  [-0.127171013660420115436752171426 &#177; &lt;2^(-100)]
  (1.60 secs, 2,382,797,736 bytes)

This is very slow because there is a lot of backtracking when target accuracy
is not reached.  Thus one should avoid making strict limit and guide too close.

The following query will automatically set the guide accuracy 20 bits above the strict limit:
-}</span><span>
</span><a name="line-64"></a><a name="sumSines1_run3"><a href="Introduction.html#sumSines1_run3"><span class="hs-identifier">sumSines1_run3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Introduction.html#sumSines1"><span class="hs-identifier hs-var">sumSines1</span></a><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- which is the default request when printing a CauchyReal:</span><span>
</span><a name="line-66"></a><a name="sumSines1_run4"><a href="Introduction.html#sumSines1_run4"><span class="hs-identifier">sumSines1_run4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">print</span><span> </span><span class="hs-special">(</span><a href="Introduction.html#sumSines1"><span class="hs-identifier hs-var">sumSines1</span></a><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span>
</span><a name="line-69"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-70"></a><span class="hs-comment">-- real number comparisons</span><span>
</span><a name="line-71"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">{-
  First consider comparisons of real number approximations.
  These may be decided or undecided, using Maybe.
-}</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-identifier">pi100</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MPBall</span><span>
</span><a name="line-79"></a><a name="pi100"><a href="Introduction.html#pi100"><span class="hs-identifier">pi100</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span class="hs-operator hs-var">?</span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-identifier">compare_run1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-82"></a><a name="compare_run1"><a href="Introduction.html#compare_run1"><span class="hs-identifier">compare_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Introduction.html#pi100"><span class="hs-identifier hs-var">pi100</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- returns: Just True</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><a name="compare_run2"><a href="Introduction.html#compare_run2"><span class="hs-identifier">compare_run2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Introduction.html#pi100"><span class="hs-identifier hs-var">pi100</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="Introduction.html#pi100"><span class="hs-identifier hs-var">pi100</span></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- returns: Nothing</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-comment">{-
  Comparison of real numbers are not decidable.
  Nevertheless, the result of such a comparison
  can be computably approximated using a sequence of Booleans.
-}</span><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span class="hs-identifier">compare_run3</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Sequence</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span>
</span><a name="line-95"></a><a name="compare_run3"><a href="Introduction.html#compare_run3"><span class="hs-identifier">compare_run3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- in ghci prints: Just True</span><span>
</span><a name="line-97"></a><span class="hs-comment">-- (evaluated using default accuracy bitsS 100)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><a name="compare_run4"><a href="Introduction.html#compare_run4"><span class="hs-identifier">compare_run4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">0.5</span><span class="hs-operator hs-var">^!</span><span class="hs-number">1000</span><span>
</span><a name="line-100"></a><span class="hs-comment">-- in ghci prints: Nothing</span><span>
</span><a name="line-101"></a><span class="hs-comment">-- (evaluated using default accuracy bitsS 100)</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><a name="compare_run5"><a href="Introduction.html#compare_run5"><span class="hs-identifier">compare_run5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">0.5</span><span class="hs-operator hs-var">^!</span><span class="hs-number">1000</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">1000</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- returns: Just False</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><a name="compare_run6"><a href="Introduction.html#compare_run6"><span class="hs-identifier">compare_run6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">real</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- in ghci prints: Just True</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- this is decided in finite time because 0 is represented exactly</span><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><a name="compare_run7"><a href="Introduction.html#compare_run7"><span class="hs-identifier">compare_run7</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">pi</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">10000</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- returns: Nothing</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- (cannot confirm pi=pi in finite time)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-115"></a><span class="hs-comment">-- checking partial functions</span><span>
</span><a name="line-116"></a><span class="hs-comment">------------------------------</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-comment">{-
  Normally in Haskell computation such as 1/0 or sqrt (-1) result
  in a run-time exception.  When using AERN2 with mixed-types-num
  (the default), these expressions do not throw exceptions, but
  return special values that describe the error.  These values are
  propagated through expressions and can be caught at any level of the expression.

  Please see
-}</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-identifier">partialfn_run1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CN</span><span> </span><span class="hs-identifier hs-type">MPBall</span><span>
</span><a name="line-129"></a><a name="partialfn_run1"><a href="Introduction.html#partialfn_run1"><span class="hs-identifier">partialfn_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; partialfn_run1
{[(ERROR,out of range: sqrt: argument must be &gt;= 0: [-1.0 &#177; 0])]}
-}</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">{- Now let us catch/inspect collected errors: -}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">partialfn_run2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">MPBall</span><span>
</span><a name="line-137"></a><a name="partialfn_run2"><a href="Introduction.html#partialfn_run2"><span class="hs-identifier">partialfn_run2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-138"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679073060"><a href="#local-6989586621679073060"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-139"></a><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">ensureNoCN</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sqrt</span><span> </span><a href="#local-6989586621679073060"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">bitsS</span><span> </span><span class="hs-number">100</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679073061"><a href="#local-6989586621679073061"><span class="hs-identifier">r</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679073062"><a href="#local-6989586621679073062"><span class="hs-identifier">_errors</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679073061"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679073063"><a href="#local-6989586621679073063"><span class="hs-identifier">_errors</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><a name="partialfn_run3"><a href="Introduction.html#partialfn_run3"><span class="hs-identifier">partialfn_run3</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-144"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; partialfn_run3
[0.0 &#177; 0]
-}</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-comment">{-
 When computing on approximations which do not have enough information
 to check whether an error occurs, we get a *potential* error:
-}</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><a name="partialfn_run4"><a href="Introduction.html#partialfn_run4"><span class="hs-identifier">partialfn_run4</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">-</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; partialfn_run4
[2.82118644197349001912496768933e-37 &#177; &lt;2^(-121)]{[(POTENTIAL ERROR,out of range: sqrt: argument must be &gt;= 0: [0.0 &#177; &lt;2^(-240)])]}
-}</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">{-
  When we are sure the potential error will not occur, we can erase it,
  risking a run-time exception if we get it wrong:
-}</span><span>
</span><a name="line-164"></a><span>
</span><a name="line-165"></a><a name="partialfn_run5"><a href="Introduction.html#partialfn_run5"><span class="hs-identifier">partialfn_run5</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">~!</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">-</span><span class="hs-identifier hs-var">pi</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; partialfn_run5
[2.82118644197349001912496768933e-37 &#177; &lt;2^(-121)]
-}</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><a name="partialfn_run6"><a href="Introduction.html#partialfn_run6"><span class="hs-identifier">partialfn_run6</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">~!</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sqrt</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">-</span><span class="hs-identifier hs-var">pi</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><span class="hs-comment">{- ghci log:
*Introduction&gt; partialfn_run6
*** Exception: WithGlobalParam ensureNoCE: []

FIXME: the above should print a description of the exception...
-}</span><span>
</span><a name="line-178"></a><span>
</span><a name="line-179"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-180"></a><span class="hs-comment">-- &quot;parallel&quot; branching for real numbers</span><span>
</span><a name="line-181"></a><span class="hs-comment">--------------------------------</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-identifier">myabs0</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span>
</span><a name="line-184"></a><a name="myabs0"><a href="Introduction.html#myabs0"><span class="hs-identifier">myabs0</span></a></a><span> </span><a name="local-6989586621679073064"><a href="#local-6989586621679073064"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679073064"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679073064"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679073064"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-keyword">type</span><span> </span><a name="RCN"><a href="Introduction.html#RCN"><span class="hs-identifier">RCN</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">CauchyRealCN</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-identifier">myabs1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Introduction.html#RCN"><span class="hs-identifier hs-type">RCN</span></a><span>
</span><a name="line-189"></a><a name="myabs1"><a href="Introduction.html#myabs1"><span class="hs-identifier">myabs1</span></a></a><span> </span><a name="local-6989586621679073065"><a href="#local-6989586621679073065"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679073065"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679073065"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679073065"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-identifier">myabs2</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span>
</span><a name="line-192"></a><a name="myabs2"><a href="Introduction.html#myabs2"><span class="hs-identifier">myabs2</span></a></a><span> </span><a name="local-6989586621679073066"><a href="#local-6989586621679073066"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">~!</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679073066"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><a href="#local-6989586621679073066"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679073066"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span class="hs-comment">---------------------------------</span><span>
</span><a name="line-195"></a><span class="hs-comment">-- Computing limits</span><span>
</span><a name="line-196"></a><span class="hs-comment">--------------------------------</span><span>
</span><a name="line-197"></a><span>
</span><a name="line-198"></a><span class="hs-comment">-- TODO</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-comment">-----------------------------------------</span><span>
</span><a name="line-202"></a><span class="hs-comment">-- Cauchy reals vs iRRAM style execution</span><span>
</span><a name="line-203"></a><span class="hs-comment">-----------------------------------------</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-identifier">logistic1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067380"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067380"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-206"></a><a name="logistic1"><a href="Introduction.html#logistic1"><span class="hs-identifier">logistic1</span></a></a><span> </span><a name="local-6989586621679073067"><a href="#local-6989586621679073067"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679073068"><a href="#local-6989586621679073068"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679073069"><a href="#local-6989586621679073069"><span class="hs-identifier">x0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679073068"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679073070"><span class="hs-identifier hs-var">lg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679073069"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>  </span><a name="local-6989586621679073070"><a href="#local-6989586621679073070"><span class="hs-identifier">lg</span></a></a><span> </span><a name="local-6989586621679073071"><a href="#local-6989586621679073071"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679073067"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679073071"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">-</span><a href="#local-6989586621679073071"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><a name="logisticR_run1"><a href="Introduction.html#logisticR_run1"><span class="hs-identifier">logisticR_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Introduction.html#logistic1"><span class="hs-identifier hs-var">logistic1</span></a><span> </span><span class="hs-number">3.82</span><span> </span><span class="hs-number">1000</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">real</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><a name="logisticMB1_run1"><a href="Introduction.html#logisticMB1_run1"><span class="hs-identifier">logisticMB1_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-214"></a><span>  </span><a href="Introduction.html#logistic1"><span class="hs-identifier hs-var">logistic1</span></a><span> </span><span class="hs-number">3.82</span><span> </span><span class="hs-number">1000</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mpBallP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">1000</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span>
</span><a name="line-215"></a><a name="logisticMB1_run2"><a href="Introduction.html#logisticMB1_run2"><span class="hs-identifier">logisticMB1_run2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-216"></a><span>  </span><a href="Introduction.html#logistic1"><span class="hs-identifier hs-var">logistic1</span></a><span> </span><span class="hs-number">3.82</span><span> </span><span class="hs-number">1000</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mpBallP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">2000</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-identifier">logistic2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679067378"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679067378"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-219"></a><a name="logistic2"><a href="Introduction.html#logistic2"><span class="hs-identifier">logistic2</span></a></a><span> </span><a name="local-6989586621679074691"><a href="#local-6989586621679074691"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679074692"><a href="#local-6989586621679074692"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679074693"><a href="#local-6989586621679074693"><span class="hs-identifier">x0</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl1</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">replicate</span><span> </span><a href="#local-6989586621679074692"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679074694"><span class="hs-identifier hs-var">lg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679074693"><span class="hs-identifier hs-var">x0</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-222"></a><span>  </span><a name="local-6989586621679074694"><a href="#local-6989586621679074694"><span class="hs-identifier">lg</span></a></a><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-223"></a><span>  </span><span class="hs-identifier">lg</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679074695"><a href="#local-6989586621679074695"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">getAccuracy</span><span> </span><a href="#local-6989586621679074696"><span class="hs-identifier hs-var">res</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679074696"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-225"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-226"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-6989586621679074696"><a href="#local-6989586621679074696"><span class="hs-identifier">res</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679074691"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679074695"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-glyph">-</span><a href="#local-6989586621679074695"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><a name="logisticMB2_run1"><a href="Introduction.html#logisticMB2_run1"><span class="hs-identifier">logisticMB2_run1</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-230"></a><span>  </span><a href="Introduction.html#logistic2"><span class="hs-identifier hs-var">logistic2</span></a><span> </span><span class="hs-number">3.82</span><span> </span><span class="hs-number">10000</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mpBallP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">10000</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span>
</span><a name="line-231"></a><a name="logisticMB2_run2"><a href="Introduction.html#logisticMB2_run2"><span class="hs-identifier">logisticMB2_run2</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-232"></a><span>  </span><a href="Introduction.html#logistic2"><span class="hs-identifier hs-var">logistic2</span></a><span> </span><span class="hs-number">3.82</span><span> </span><span class="hs-number">10000</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mpBallP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">20000</span><span class="hs-special">)</span><span> </span><span class="hs-number">0.5</span><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">logisticIter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Rational</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span>
</span><a name="line-235"></a><a name="logisticIter"><a href="Introduction.html#logisticIter"><span class="hs-identifier">logisticIter</span></a></a><span> </span><a name="local-6989586621679075299"><a href="#local-6989586621679075299"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679075300"><a href="#local-6989586621679075300"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-236"></a><span>  </span><a href="Introduction.html#irramEval"><span class="hs-identifier hs-var">irramEval</span></a><span> </span><span class="hs-special">(</span><a href="Introduction.html#logistic2"><span class="hs-identifier hs-var">logistic2</span></a><span> </span><a href="#local-6989586621679075299"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679075300"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-identifier">irramEval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MPBall</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">MPBall</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Introduction.html#R"><span class="hs-identifier hs-type">R</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><a name="irramEval"><a href="Introduction.html#irramEval"><span class="hs-identifier">irramEval</span></a></a><span> </span><a name="local-6989586621679075301"><a href="#local-6989586621679075301"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679075302"><a href="#local-6989586621679075302"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-identifier hs-var">newCR</span><span> </span><span class="hs-string">&quot;irramEval&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679075303"><span class="hs-identifier hs-var">getAnswer</span></a><span>
</span><a name="line-241"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-242"></a><span>  </span><a name="local-6989586621679075303"><a href="#local-6989586621679075303"><span class="hs-identifier">getAnswer</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">AccuracySG</span><span> </span><a name="local-6989586621679075304"><a href="#local-6989586621679075304"><span class="hs-identifier">acS</span></a></a><span> </span><a name="local-6989586621679075305"><a href="#local-6989586621679075305"><span class="hs-identifier">_acG</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">last</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">iterateUntilAccurate</span><span> </span><a href="#local-6989586621679075304"><span class="hs-identifier hs-var">acS</span></a><span> </span><a href="#local-6989586621679075306"><span class="hs-identifier hs-var">withPrecision</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-244"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679075498"><a href="#local-6989586621679075498"><span class="hs-identifier">res</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679075498"><span class="hs-identifier hs-var">res</span></a><span>
</span><a name="line-245"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;irramEval failed&quot;</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-247"></a><span>    </span><a name="local-6989586621679075306"><a href="#local-6989586621679075306"><span class="hs-identifier">withPrecision</span></a></a><span> </span><a name="local-6989586621679075307"><a href="#local-6989586621679075307"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679075301"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679075308"><span class="hs-identifier hs-var">xWithP</span></a><span>
</span><a name="line-248"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-249"></a><span>      </span><a name="local-6989586621679075308"><a href="#local-6989586621679075308"><span class="hs-identifier">xWithP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">setPrecision</span><span> </span><a href="#local-6989586621679075307"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679075302"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">?</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">accuracySG</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">bits</span><span> </span><a href="#local-6989586621679075307"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">{-
  Recommended further reading:  ClosestPairDist.hs
-}</span><span>
</span><a name="line-254"></a></pre></body></html>